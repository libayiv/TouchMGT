<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.security.modules.touch.dao.FileListDao">

	<resultMap type="FileListEntity" id="FileListEntityMap">
		<result column="FILE_ID" property="file_id"/>
		<result column="FILE_PATH" property="file_path"/>
		<result column="FILE_TYPE" property="file_type"/>
		<result column="FILENAME" property="filename"/>
		<result column="INTRO" property="intro"/>
		<result column="STATUS" property="status"/>
		<result column="PUBDATE" property="pubdate"/>
	</resultMap>
	
	<select id="queryObject" parameterType="java.lang.String" resultMap="FileListEntityMap">
		SELECT 
		<include refid="base" />
		FROM
		<include refid="tableName" />
		WHERE FILE_ID = #{pid}
	</select>

	<select id="queryList" parameterType="java.util.Map" resultMap="FileListEntityMap">
		SELECT 
		<include refid="base" />
		FROM
		<include refid="tableName" />
		<include refid="mapWhere" />
		ORDER BY PUBDATE DESC
	</select>
	
	<sql id="tableName">
		BFCMS_FILE_LIST
	</sql>
	
	<sql id="mapWhere">
		<where>
			<if test="file_id != null and file_id != ''">
				AND FILE_ID = #{file_id}
			</if>
			<if test="file_path != null and file_path != ''">
				AND FILE_PATH = #{file_path}
			</if>
			<if test="file_type != null and file_type != ''">
				AND FILE_TYPE = #{file_type}
			</if>
			<if test="filename != null and filename != ''">
				AND FILENAME = #{filename}
			</if>
			<if test="intro != null and intro != ''">
				AND INTRO = #{intro}
			</if>
			<if test="status != null and status != ''">
				AND STATUS = #{status}
			</if>
			<if test="pubdate != null and pubdate != ''">
				AND PUBDATE = #{pubdate}
			</if>
		</where>
	</sql>
 	<select id="queryTotal" resultType="int">
		select count(*) from BFCMS_FILE_LIST 
	</select>
	 
	 <sql id="base">
		FILE_ID,FILE_PATH,FILE_TYPE,FILENAME,INTRO,STATUS,PUBDATE
	</sql>
	
	<insert id="save" parameterType="FileListEntity">
		insert into BFCMS_FILE_LIST
		(
			<include refid="base" />
		)
		values
		(
			#{file_id,jdbcType=VARCHAR}, 
			#{file_path,jdbcType=VARCHAR},
			#{file_type,jdbcType=VARCHAR}, 
			#{filename,jdbcType=VARCHAR},
			#{intro,jdbcType=VARCHAR}, 
			#{status,jdbcType=VARCHAR},
			SYSDATE
		)
	</insert>
	 
	<update id="update" parameterType="FileListEntity">
		update BFCMS_FILE_LIST 
		<include refid="set" />
		where FILE_ID = #{file_id}
	</update>
	
	<update id="updateStatus" parameterType="java.util.Map">
		UPDATE
		<include refid="tableName" />
		SET STATUS = #{status}
		WHERE
		FILE_ID IN
		<foreach collection="list" index="index" item="item" open="(" separator="," close=")">
			#{item}
		</foreach>
	</update>
	
	<delete id="delete">
		delete from BFCMS_FILE_LIST where id = #{value}
	</delete>
	
	<delete id="deleteBatch">
		delete from BFCMS_FILE_LIST where FILE_ID in 
		<foreach item="id" collection="array" open="(" separator="," close=")">
			#{id}
		</foreach>
	</delete>

	<sql id="set">
		<set>
			pubdate = SYSDATE, 
			<if test="file_id != null and file_id != ''">
				file_id = #{file_id},
			</if>
			<if test="file_path != null and file_path != ''">
				file_path = #{file_path},
			</if>
			<if test="file_type != null and file_type != ''">
				file_type = #{file_type},
			</if>
			<if test="filename != null and filename != ''">
				filename = #{filename},
			</if>
			<if test="intro != null and intro != ''">
				intro = #{intro},
			</if>
			<if test="status != null and status != ''">
				STATUS = #{status}, 
			</if>		
		</set>
	</sql>
</mapper>